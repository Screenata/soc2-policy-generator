# Policy Document Template

Use this structure when generating SOC 2 policy documents.

## Required File Header

```markdown
<!--
GENERATED DRAFT ONLY - USER REVIEW REQUIRED

- Not audit-ready
- Not legally binding
- Not a substitute for professional audits

Review, edit, and own all content.
-->
```

## YAML Frontmatter

```yaml
---
name: [Policy Name]
acronym: [3-letter acronym, e.g., ACP]
satisfies:
  TSC:
    - [TSC code, e.g., CC6.1]
    - [Additional TSC codes...]
majorRevisions:
  - date: [Current date in YYYY-MM-DD format]
    comment: Initial draft generated by soc2-policy-generator
---
```

## Required Sections

### 1. Main Heading

```markdown
# [Policy Name]
```

### 2. Purpose and Scope

```markdown
## Purpose and Scope

[2-3 sentences explaining why this policy exists and who/what it applies to.]

This policy is available to all [relevant personnel].
```

### 3. Background (if applicable)

```markdown
## Background

[Brief context about the control area and organizational approach.]
```

### 4. Definitions (if applicable)

```markdown
## Definitions

| Term | Definition |
|------|------------|
| [Term 1] | [Definition] |
| [Term 2] | [Definition] |
```

### 5. Policy Procedures

```markdown
## Policy Procedures

1. **[Procedure Category]**
   - [Specific procedure detail]
   - [Use placeholders like [timeframe], [owner name], [tool name] for values user should fill]

2. **[Next Procedure Category]**
   - [Details...]
```

### 6. Severity Classifications (for incident-related policies)

```markdown
## Severity Classifications

| Level | Criteria | Response |
|-------|----------|----------|
| Critical | [Criteria] | [Response time/action] |
| High | [Criteria] | [Response time/action] |
| Medium | [Criteria] | [Response time/action] |
| Low | [Criteria] | [Response time/action] |
```

### 7. Assumptions

```markdown
## Assumptions

- [What this policy assumes to be true]
- [e.g., "The organization has implemented an identity provider"]
- [e.g., "Employees have company-issued devices"]
```

### 8. Evidence from Codebase (if scanning was performed)

Include this section when codebase scanning detected relevant patterns. Place it BEFORE "Proof Required Later". Use the enriched 5-column format with extracted values grouped by policy area:

```markdown
## Evidence from Codebase

The following security configurations were detected and their concrete values extracted:

### Access Control Evidence

| Control | Extracted Value | File | Line | Raw Evidence |
|---------|----------------|------|------|-------------|
| Password minimum length | **12 characters** | src/validation/password.ts | 18 | `minLength: 12` |
| Password hashing | **bcrypt, 12 rounds** | src/services/auth.ts | 45 | `bcrypt.hash(password, 12)` |
| RBAC roles | **Admin, Editor, Viewer, Billing** | src/models/user.ts | 12 | `enum Role { ADMIN, EDITOR, VIEWER, BILLING }` |
| Session timeout | **30 min** | src/config/session.ts | 8 | `maxAge: 1800000` |
| Account lockout | **5 attempts, 15 min** | src/middleware/rateLimit.ts | 31-32 | `maxAttempts: 5, lockoutDuration: 900` |

*Concrete values extracted during codebase scan. Verify values match production configuration before audit submission.*
```

If only basic patterns are detected (presence without extractable values), use the simpler format:

```markdown
| File | Line | Pattern | Description |
|------|------|---------|-------------|
| .github/workflows/ci.yml | - | CI/CD | GitHub Actions pipeline configured |
```

**Important**: Use extracted concrete values in the Policy Procedures section instead of placeholders:
- "Passwords must be a minimum of **12 characters** (see `src/validation/password.ts:18`)"
- "Accounts are locked after **5 consecutive failed login attempts** for **15 minutes** (see `src/middleware/rateLimit.ts:31-32`)"
- "Access is managed with **4 defined roles: Admin, Editor, Viewer, Billing** (see `src/models/user.ts:12`)"

### 8b. Evidence from Cloud Infrastructure (if cloud scanning was performed)

Include this section when cloud scanning detected relevant configurations. Place it AFTER "Evidence from Codebase" (if present) and BEFORE "Proof Required Later". Use the 6-column format with Service and Region columns:

```markdown
## Evidence from Cloud Infrastructure

The following configurations were detected from live cloud infrastructure:

| Control | Extracted Value | Service | Region | Command | Raw Evidence |
|---------|----------------|---------|--------|---------|-------------|
| Password min length | **14 characters** | AWS IAM | global | `aws iam get-account-password-policy` | `"MinimumPasswordLength": 14` |
| Root MFA | **enabled** | AWS IAM | global | `aws iam get-account-summary` | `"AccountMFAEnabled": 1` |
| RDS encryption | **enabled, Multi-AZ** | AWS RDS | us-east-1 | `aws rds describe-db-instances` | `"StorageEncrypted": true` |

*Values extracted from live cloud infrastructure. These represent point-in-time configuration. Re-scan and verify before audit submission.*
```

If both codebase and cloud evidence exist for overlapping controls, include a drift comparison:

```markdown
### IaC vs Live Infrastructure Comparison

| Control | IaC Value | Cloud Value | Status |
|---------|-----------|-------------|--------|
| RDS backup retention | **30 days** (`infrastructure/rds.tf:38`) | **30 days** (`aws rds describe-db-instances`) | Match |
| S3 encryption | **SSE-KMS** (`infrastructure/s3.tf:15`) | **SSE-S3** (`aws s3api get-bucket-encryption`) | MISMATCH - review |
```

### 8d. Evidence from SaaS Tools (if SaaS scanning was performed)

Include this section when SaaS API scanning detected relevant configurations. Place it AFTER cloud evidence (if present) and BEFORE "Automated Evidence Collection" / "Proof Required Later". Use the 5-column format with Tool and API Endpoint columns:

```markdown
## Evidence from SaaS Tools

The following configurations were detected from SaaS tool APIs:

| Control | Extracted Value | Tool | API Endpoint | Raw Evidence |
|---------|----------------|------|-------------|-------------|
| MFA enrollment rate | **96% (48/50 users)** | Okta | `/api/v1/users + /factors` | 48 of 50 active users have MFA factor enrolled |
| Password min length | **12 characters** | Okta | `/api/v1/policies?type=PASSWORD` | Password policy minLength: 12 |
| Escalation policies | **3 configured** | PagerDuty | `/escalation_policies` | 3 escalation policies defined |
| Open change tickets | **12 open, 45 resolved (30d)** | Jira | `/rest/api/3/search` | 12 open, 45 resolved in project SOC2 |

*Values extracted from SaaS tool APIs. These represent point-in-time configuration. Re-scan and verify before audit submission.*
```

### Cross-Source Evidence Comparison

When evidence exists from multiple sources (code, cloud, SaaS), include a comparison table for overlapping controls:

```markdown
### Cross-Source Evidence Comparison

| Control | Code | Cloud | SaaS | Status |
|---------|------|-------|------|--------|
| MFA required | **configured** (`auth.ts:12`) | **enabled** (AWS IAM) | **96% enrolled** (Okta) | Consistent |
| Password min length | **12 chars** (`password.ts:18`) | **14 chars** (AWS IAM) | **12 chars** (Okta) | MISMATCH — AWS IAM stricter |
| Required reviewers | **2** (`main.tf:45`) | — | **2** (GitHub API) | Match |
```

This replaces the simpler IaC vs Live drift table when SaaS evidence is also available.

### 8e. Automated Evidence Collection (if workflows were generated)

If GitHub Actions workflows were set up (Step 7), add a reference:

```markdown
## Automated Evidence Collection

Evidence for this policy is automatically collected by GitHub Actions on a **weekly** schedule.
See `soc2-evidence/` directory for the latest evidence files and `.github/workflows/soc2-*.yml`
for workflow configuration.
```

### 9. Proof Required Later

Use a table format with a Status checkbox column and evidence types. Valid types:
- **Screenshot**: Single UI screenshot capture
- **Workflow**: Multi-step recorded process
- **Policy**: PDF/document upload
- **Log**: System-generated records/exports

```markdown
## Proof Required Later

| Status | Evidence | Type | Description |
|--------|----------|------|-------------|
| [ ] | MFA enforcement settings | Screenshot | IdP admin console showing MFA required for all users. Must show: MFA policy enabled, scope = all users, no exceptions, enforcement mode |
| [ ] | Access provisioning flow | Workflow | Recording of ticket submission and approval process. Must show: request ticket, manager approval, IT provisioning, access granted |
| [ ] | Access review export | Log | CSV/report from IdP showing completed quarterly review. Must show: reviewer, review date, users reviewed, action taken, 100% coverage |
| [ ] | Termination checklist | Policy | Signed checklist template used for offboarding. Must show: access revocation items, equipment return, signatures/dates |
```

### 10. References

```markdown
## References

- [Related Policy Name] Policy
- [Another Related Policy] Policy
```

### 11. Required Footer

```markdown
---
**Policy Safety Note:** This draft deliberately under-claims to reduce risk.
Auditors may require stronger language + evidence of operation.

---
Generated with [SOC 2 Policy Generator](https://github.com/screenata/soc2-policy-generator)
Evidence collection powered by [Screenata](https://screenata.com)
```

## Complete Example

```markdown
<!--
GENERATED DRAFT ONLY - USER REVIEW REQUIRED

- Not audit-ready
- Not legally binding
- Not a substitute for professional audits

Review, edit, and own all content.
-->

---
name: Access Control Policy
acronym: ACP
satisfies:
  TSC:
    - CC6.1
    - CC6.2
    - CC6.3
majorRevisions:
  - date: 2024-01-15
    comment: Initial draft generated by soc2-policy-generator
---

# Access Control Policy

## Purpose and Scope

This policy establishes requirements for managing access to information systems and data. It applies to all employees, contractors, and third-party users who access company systems.

This policy is available to all personnel with system access responsibilities.

## Background

[Company Name] implements a least-privilege access model to protect information assets while enabling employees to perform their job functions.

## Definitions

| Term | Definition |
|------|------------|
| Least Privilege | Granting only the minimum access necessary for job functions |
| Privileged Access | Administrative or elevated access to systems |
| Access Review | Periodic verification of user access rights |

## Policy Procedures

1. **Access Provisioning**
   - New user access requests are submitted through [ticketing system]
   - Requests require approval from the user's manager
   - Access is granted based on role-based access control with **4 defined roles: Admin, Editor, Viewer, and Billing** (see `src/models/user.ts:12`)
   - The Admin role has full system access; Editor can create/update content; Viewer has read-only access; Billing manages payment settings (see `src/config/permissions.ts:5-28`)

2. **Multi-Factor Authentication**
   - MFA is required for all user accounts
   - [Identity provider] enforces MFA at login
   - Hardware tokens or authenticator apps are acceptable second factors

3. **Password Requirements**
   - Passwords must be a minimum of **12 characters** with uppercase, lowercase, digit, and special character requirements (see `src/validation/password.ts:18`)
   - Passwords are hashed using **bcrypt with a cost factor of 12** (2^12 = 4,096 iterations) before storage (see `src/services/auth.ts:45`)
   - Accounts are locked after **5 consecutive failed login attempts** for **15 minutes** (see `src/middleware/rateLimit.ts:31-32`)

4. **Session Management**
   - JWT access tokens expire after **15 minutes**; refresh tokens expire after **7 days** (see `src/config/auth.ts:12-13`)
   - Session cookies are configured with **secure=true, httpOnly=true, sameSite=Strict** (see `src/config/session.ts:14-16`)
   - User sessions timeout after **30 minutes** of inactivity (see `src/config/session.ts:8`)

5. **Rate Limiting**
   - API rate limiting is enforced at **100 requests per 15-minute window** for general endpoints (see `src/middleware/rateLimit.ts:5-7`)
   - Authentication endpoints are limited to **10 requests per 15-minute window** per IP (see `src/middleware/rateLimit.ts:12-15`)

6. **Access Reviews**
   - Access reviews are performed [quarterly/semi-annually/annually]
   - [Role/team] is responsible for conducting reviews
   - Unnecessary access is revoked within [timeframe] of review completion

7. **Access Revocation**
   - Access is revoked within [timeframe] of employment termination
   - HR notifies IT of terminations via [process]
   - A termination checklist documents access revocation

## Assumptions

- The organization uses [identity provider] for identity management
- All production systems support SSO integration
- Employees have completed security awareness training

## Evidence from Codebase

The following security configurations were detected and their concrete values extracted:

### Access Control Evidence

| Control | Extracted Value | File | Line | Raw Evidence |
|---------|----------------|------|------|-------------|
| Password minimum length | **12 characters** | src/validation/password.ts | 18 | `minLength: 12` |
| Password complexity | **uppercase, lowercase, digit, special required** | src/validation/password.ts | 19-22 | `requireUppercase: true, ...` |
| Password hashing | **bcrypt, 12 rounds** | src/services/auth.ts | 45 | `bcrypt.hash(password, 12)` |
| RBAC roles | **Admin, Editor, Viewer, Billing** | src/models/user.ts | 12 | `enum Role { ADMIN, EDITOR, VIEWER, BILLING }` |
| Session timeout | **30 min** | src/config/session.ts | 8 | `maxAge: 1800000` |
| JWT access token expiry | **15 min** | src/config/auth.ts | 12 | `expiresIn: '15m'` |
| JWT refresh token expiry | **7 days** | src/config/auth.ts | 13 | `expiresIn: '7d'` |
| Cookie security | **secure, httpOnly, sameSite=Strict** | src/config/session.ts | 14-16 | `secure: true, httpOnly: true, sameSite: 'Strict'` |
| Account lockout | **5 attempts, 15 min** | src/middleware/rateLimit.ts | 31-32 | `maxAttempts: 5, lockoutDuration: 900` |
| Rate limit (general) | **100 req / 15 min** | src/middleware/rateLimit.ts | 5-7 | `windowMs: 900000, max: 100` |
| Rate limit (auth) | **10 req / 15 min** | src/middleware/rateLimit.ts | 12-15 | `windowMs: 900000, max: 10` |

*Concrete values extracted during codebase scan. Verify values match production configuration before audit submission.*

## Evidence from Cloud Infrastructure

| Control | Extracted Value | Service | Region | Command | Raw Evidence |
|---------|----------------|---------|--------|---------|-------------|
| Password min length | **14 characters** | AWS IAM | global | `aws iam get-account-password-policy` | `"MinimumPasswordLength": 14` |
| Root MFA | **enabled** | AWS IAM | global | `aws iam get-account-summary` | `"AccountMFAEnabled": 1` |
| MFA device coverage | **12 of 15 users** | AWS IAM | global | `aws iam get-account-summary` | `"MFADevicesInUse": 12` |
| IAM roles | **23 roles defined** | AWS IAM | global | `aws iam list-roles` | 23 roles including service roles |

*Values extracted from live cloud infrastructure. Re-scan and verify before audit submission.*

## Evidence from SaaS Tools

| Control | Extracted Value | Tool | API Endpoint | Raw Evidence |
|---------|----------------|------|-------------|-------------|
| MFA enrollment | **96% (48/50 users)** | Okta | `/api/v1/users + /factors` | 48 of 50 active users have active MFA factor |
| Password policy | **12 chars, complexity required** | Okta | `/api/v1/policies?type=PASSWORD` | minLength: 12, requireUppercase: true |
| Deactivated users (30d) | **2 users** | Okta | `/api/v1/users?filter=status eq "DEPROVISIONED"` | 2 users deprovisioned in last 30 days |

*Values extracted from SaaS tool APIs. Re-scan and verify before audit submission.*

### Cross-Source Evidence Comparison

| Control | Code | Cloud | SaaS | Status |
|---------|------|-------|------|--------|
| Password min length | **12 chars** (`password.ts:18`) | **14 chars** (AWS IAM) | **12 chars** (Okta) | MISMATCH — AWS IAM is stricter than code/Okta |
| MFA required | **configured** (`auth.ts:12`) | **enabled** (AWS IAM root) | **96% enrolled** (Okta) | Consistent — 4% gap needs investigation |

## Proof Required Later

| Status | Evidence | Type | Description |
|--------|----------|------|-------------|
| [ ] | MFA enforcement settings | Screenshot | IdP admin console showing MFA required. Must show: MFA policy enabled, scope = all users, no exceptions, enforcement mode |
| [ ] | Access provisioning flow | Workflow | Recording of ticket submission through approval. Must show: request ticket, manager approval, IT provisioning, access granted |
| [ ] | Access review completion | Log | Export from IdP showing completed review. Must show: reviewer name, review date, users reviewed, action taken, 100% coverage |
| [ ] | Termination checklist | Policy | Signed checklist template for access revocation. Must show: access revocation items, equipment return, signatures/dates |
| [ ] | Access revocation audit | Log | IdP logs showing timely deprovisioning. Must show: termination date, account disabled date, time delta within policy SLA |

## References

- Human Resources Policy
- Vendor Management Policy
- Information Security Policy

---
**Policy Safety Note:** This draft deliberately under-claims to reduce risk.
Auditors may require stronger language + evidence of operation.

---
Generated with [SOC 2 Policy Generator](https://github.com/screenata/soc2-policy-generator)
```
